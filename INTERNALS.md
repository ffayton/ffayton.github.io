# Sherlock tangly web of webs

## Overview

The Sherlock web site has three components, each living in its own branch of
the [stanford-rc/www.sherlock.stanford.edu][url_repo] GitHub repository.

| Component | Build status | Branch |
| --------- | ------------ | ------ |
| [landing page][url_landing_branch]      | [![Build Status][img_landing_buildstatus]][url_travis_branches] | [`landing`][url_landing_branch] |
| [documentation theme][url_theme_branch] | [![Build Status][img_theme_buildstatus]][url_travis_branches]   | [`theme`][url_theme_branch]     |
| [documentation pages][url_docs_branch]  | [![Build Status][img_docs_buildstatus]][url_travis_branches]    | [`docs`][url_docs_branch]       |

Each of those components has two parts:

  * a *source* directory, where modifications can be done,
  * a *build* directory, where final output is generated by a script

## Workflow

Each branch contains a [Travis][url_travis] configuration file, that will, on
each commit:

1. build the branch contents
2. deploy the generated contents if the build was successful

So for instance, a commit in the landing page branch will generate a Travis
build of the landing page, and the resulting HTML contents will be pushed and
committed to the `src/` directory in the `docs` branch.

This `docs` branch commit will in turn generate a Travis build of the
MkDocs pages, which will get pushed to the `gh-pages` branch for final
publication.

Basically:
* commit to landing page -> commit to docs -> publication
* commit to theme -> commit to docs -> publication
* commit to docs -> publication

This way, any change to any of the components will be automatically reflected
in the published site. But a modification to the landing page does not require
rebuilding the theme. And an update of the docs content does not trigger a full
rebuild of the landing page nor the theme either, just the docs themselves.

So the only required step when modifying one of the components is to commit the
changes and push them to GitHub.

Here's an overview of the whole workflow:

![webs][url_webs]
([edit][url_webs_edit])




[url_mkdocs]:           http://mkdocs.org
[url_travis]:           https://travisci.com
[url_travis_branches]:  https://travis-ci.com/stanford-rc/www.sherlock.stanford.edu/branches

[url_repo]:             https://github.com/stanford-rc/www.sherlock.stanford.edu
[url_landing_branch]:   https://github.com/stanford-rc/www.sherlock.stanford.edu/tree/landing
[url_theme_branch]:     https://github.com/stanford-rc/www.sherlock.stanford.edu/tree/theme
[url_docs_branch]:      https://github.com/stanford-rc/www.sherlock.stanford.edu/tree/docs
[url_mkdocs_material]:  https://squidfunk.github.io/mkdocs-material

[url_webs]:      https://docs.google.com/drawings/d/1ja1TyamMKqiemhwW7ZJgdSbmD9wy7xGXhPkNxOEvPE4/pub?w=842&amp;h=715
[url_webs_edit]: https://docs.google.com/drawings/d/1ja1TyamMKqiemhwW7ZJgdSbmD9wy7xGXhPkNxOEvPE4/edit

[img_landing_buildstatus]: https://travis-ci.com/stanford-rc/www.sherlock.stanford.edu.svg?token=uginarQXUTdAZXLFvqnS&branch=landing
[img_theme_buildstatus]:   https://travis-ci.com/stanford-rc/www.sherlock.stanford.edu.svg?token=uginarQXUTdAZXLFvqnS&branch=theme
[img_docs_buildstatus]:    https://travis-ci.com/stanford-rc/www.sherlock.stanford.edu.svg?token=uginarQXUTdAZXLFvqnS&branch=docs

